{"ast":null,"code":"import { thumpBegin, thumpFail, thumpSuccess } from './thumpAction';\n\nconst thumpThunk = (imageId, token, thumpUpResolver = true) => {\n  return async dispatch => {\n    dispatch(thumpBegin()); // thumpUpResolver is true if the thunk will make a fetch request to thumpUpMutation\n\n    let graphqlQuery;\n\n    if (thumpUpResolver) {\n      graphqlQuery = {\n        query: `\n            mutation thumpUp($imageId: String!){\n                thumpUpMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n        variables: {\n          imageId: image\n        }\n      };\n    } else {\n      graphqlQuery = {\n        query: `\n            mutation thumpDown($imageId: String!){\n                thumpDownMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n        variables: {\n          imageId\n        }\n      };\n    }\n\n    try {\n      const response = await fetch('http://localhost:5000/graphql', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + token\n        },\n        body: JSON.stringify(graphqlQuery)\n      });\n      const resData = await response.json();\n\n      if (resData.errors) {\n        console.log(resData.errors);\n\n        if (resData.errors[0].status == 401) {\n          throw Error('You are not authorized');\n        }\n\n        throw Error('Image not found');\n      }\n\n      dispatch(thumpSuccess(resData));\n      console.log(resData);\n    } catch (error) {\n      console.log(error);\n      dispatch(thumpFail(error));\n    }\n  };\n};\n\nexport default thumpThunk;","map":{"version":3,"sources":["/home/mayor/gidiShare2/frontend/src/redux/action/thumpThunk.js"],"names":["thumpBegin","thumpFail","thumpSuccess","thumpThunk","imageId","token","thumpUpResolver","dispatch","graphqlQuery","query","variables","image","response","fetch","method","headers","Authorization","body","JSON","stringify","resData","json","errors","console","log","status","Error","error"],"mappings":"AAAA,SAAQA,UAAR,EAAoBC,SAApB,EAA+BC,YAA/B,QAAkD,eAAlD;;AAGA,MAAMC,UAAU,GAAG,CAACC,OAAD,EAAUC,KAAV,EAAiBC,eAAe,GAAG,IAAnC,KAA0C;AAEzD,SAAO,MAAMC,QAAN,IAAiB;AACpBA,IAAAA,QAAQ,CAACP,UAAU,EAAX,CAAR,CADoB,CAGxB;;AACA,QAAIQ,YAAJ;;AAEA,QAAGF,eAAH,EAAmB;AACfE,MAAAA,YAAY,GAAG;AACXC,QAAAA,KAAK,EAAG;;;;;;;;;;;;;;;;;cADG;AAmBXC,QAAAA,SAAS,EAAC;AACNN,UAAAA,OAAO,EAACO;AADF;AAnBC,OAAf;AAwBH,KAzBD,MAyBK;AACDH,MAAAA,YAAY,GAAG;AACXC,QAAAA,KAAK,EAAG;;;;;;;;;;;;;;;;;cADG;AAmBXC,QAAAA,SAAS,EAAC;AACNN,UAAAA;AADM;AAnBC,OAAf;AAwBH;;AAED,QAAG;AAEC,YAAMQ,QAAQ,GAAG,MAAMC,KAAK,CAAC,+BAAD,EAAiC;AACzDC,QAAAA,MAAM,EAAE,MADiD;AAEzDC,QAAAA,OAAO,EAAC;AACJ,0BAAgB,kBADZ;AAEJC,UAAAA,aAAa,EAAE,YAAYX;AAFvB,SAFiD;AAMzDY,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeX,YAAf;AANmD,OAAjC,CAA5B;AASA,YAAMY,OAAO,GAAG,MAAMR,QAAQ,CAACS,IAAT,EAAtB;;AACA,UAAGD,OAAO,CAACE,MAAX,EAAkB;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYJ,OAAO,CAACE,MAApB;;AACA,YAAGF,OAAO,CAACE,MAAR,CAAe,CAAf,EAAkBG,MAAlB,IAA4B,GAA/B,EAAmC;AAC/B,gBAAMC,KAAK,CAAC,wBAAD,CAAX;AACH;;AACD,cAAMA,KAAK,CAAC,iBAAD,CAAX;AAEH;;AAEDnB,MAAAA,QAAQ,CAACL,YAAY,CAACkB,OAAD,CAAb,CAAR;AACAG,MAAAA,OAAO,CAACC,GAAR,CAAYJ,OAAZ;AACH,KAvBD,CAuBC,OAAMO,KAAN,EAAY;AACTJ,MAAAA,OAAO,CAACC,GAAR,CAAYG,KAAZ;AACApB,MAAAA,QAAQ,CAACN,SAAS,CAAC0B,KAAD,CAAV,CAAR;AACH;AACJ,GArFG;AAsFH,CAxFD;;AA0FA,eAAexB,UAAf","sourcesContent":["import {thumpBegin, thumpFail, thumpSuccess} from './thumpAction'\n\n\nconst thumpThunk = (imageId, token, thumpUpResolver = true)=>{\n\n    return async dispatch =>{ \n        dispatch(thumpBegin())\n\n    // thumpUpResolver is true if the thunk will make a fetch request to thumpUpMutation\n    let graphqlQuery\n\n    if(thumpUpResolver){\n        graphqlQuery = {\n            query: `\n            mutation thumpUp($imageId: String!){\n                thumpUpMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n            variables:{\n                imageId:image\n            }\n        }\n\n    }else{\n        graphqlQuery = {\n            query: `\n            mutation thumpDown($imageId: String!){\n                thumpDownMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n            variables:{\n                imageId\n            }\n\n        }\n    }\n\n    try{\n\n        const response = await fetch('http://localhost:5000/graphql',{\n            method: 'POST',\n            headers:{\n                'Content-Type': 'application/json',\n                Authorization: 'Bearer ' + token\n            },\n            body: JSON.stringify(graphqlQuery)\n        })\n\n        const resData = await response.json()\n        if(resData.errors){\n            console.log(resData.errors)\n            if(resData.errors[0].status == 401){\n                throw Error('You are not authorized')\n            }\n            throw Error('Image not found')\n\n        }\n\n        dispatch(thumpSuccess(resData))\n        console.log(resData)\n    }catch(error){\n        console.log(error)\n        dispatch(thumpFail(error))\n    }\n}\n}\n\nexport default thumpThunk"]},"metadata":{},"sourceType":"module"}