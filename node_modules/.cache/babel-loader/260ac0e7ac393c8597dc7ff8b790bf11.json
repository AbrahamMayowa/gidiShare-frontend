{"ast":null,"code":"import { thumpBegin, thumpFail, thumpSuccess, updateSingleImageThumpDown } from './thumpAction';\n\nconst thumpThunk = (imageId, token, thumpUpResolver = true) => {\n  return async dispatch => {\n    dispatch(thumpBegin()); // thumpUpResolver is true if the thunk will make a fetch request to thumpUpMutation\n\n    let graphqlQuery;\n\n    if (thumpUpResolver) {\n      graphqlQuery = {\n        query: `\n            mutation thumpUp($imageId: ID!){\n                thumpUpMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n\n                    imageId\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n        variables: {\n          imageId: imageId\n        }\n      };\n    } else {\n      graphqlQuery = {\n        query: `\n            mutation thumpDown($imageId: ID!){\n                thumpDownMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n                    imageId\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n        variables: {\n          imageId\n        }\n      };\n    }\n\n    try {\n      const response = await fetch('http://localhost:5000/graphql', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + token\n        },\n        body: JSON.stringify(graphqlQuery)\n      });\n      const resData = await response.json();\n      console.log(resData);\n\n      if (resData.errors) {\n        console.log(resData.errors);\n\n        if (resData.errors[0].status === 401) {\n          throw Error('You are not authorized');\n        }\n\n        throw Error('Image not found');\n      }\n\n      dispatch(thumpSuccess(resData));\n      dispatch(updateSingleImage(resData));\n      console.log(resData);\n    } catch (error) {\n      console.log(error);\n      dispatch(thumpFail(error));\n    }\n  };\n};\n\nexport default thumpThunk;","map":{"version":3,"sources":["/home/mayor/gidiShare2/frontend/src/redux/action/thumpThunk.js"],"names":["thumpBegin","thumpFail","thumpSuccess","updateSingleImageThumpDown","thumpThunk","imageId","token","thumpUpResolver","dispatch","graphqlQuery","query","variables","response","fetch","method","headers","Authorization","body","JSON","stringify","resData","json","console","log","errors","status","Error","updateSingleImage","error"],"mappings":"AAAA,SAAQA,UAAR,EAAoBC,SAApB,EAA+BC,YAA/B,EAA6CC,0BAA7C,QAAgF,eAAhF;;AAGA,MAAMC,UAAU,GAAG,CAACC,OAAD,EAAUC,KAAV,EAAiBC,eAAe,GAAG,IAAnC,KAA0C;AAEzD,SAAO,MAAMC,QAAN,IAAiB;AACpBA,IAAAA,QAAQ,CAACR,UAAU,EAAX,CAAR,CADoB,CAGxB;;AACA,QAAIS,YAAJ;;AAEA,QAAGF,eAAH,EAAmB;AACfE,MAAAA,YAAY,GAAG;AACXC,QAAAA,KAAK,EAAG;;;;;;;;;;;;;;;;;;;cADG;AAqBXC,QAAAA,SAAS,EAAC;AACNN,UAAAA,OAAO,EAACA;AADF;AArBC,OAAf;AA0BH,KA3BD,MA2BK;AACDI,MAAAA,YAAY,GAAG;AACXC,QAAAA,KAAK,EAAG;;;;;;;;;;;;;;;;;;cADG;AAoBXC,QAAAA,SAAS,EAAC;AACNN,UAAAA;AADM;AApBC,OAAf;AAyBH;;AAED,QAAG;AAEC,YAAMO,QAAQ,GAAG,MAAMC,KAAK,CAAC,+BAAD,EAAiC;AACzDC,QAAAA,MAAM,EAAE,MADiD;AAEzDC,QAAAA,OAAO,EAAC;AACJ,0BAAgB,kBADZ;AAEJC,UAAAA,aAAa,EAAE,YAAYV;AAFvB,SAFiD;AAMzDW,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeV,YAAf;AANmD,OAAjC,CAA5B;AASA,YAAMW,OAAO,GAAG,MAAMR,QAAQ,CAACS,IAAT,EAAtB;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYH,OAAZ;;AACA,UAAGA,OAAO,CAACI,MAAX,EAAkB;AACdF,QAAAA,OAAO,CAACC,GAAR,CAAYH,OAAO,CAACI,MAApB;;AACA,YAAGJ,OAAO,CAACI,MAAR,CAAe,CAAf,EAAkBC,MAAlB,KAA6B,GAAhC,EAAoC;AAChC,gBAAMC,KAAK,CAAC,wBAAD,CAAX;AACH;;AACD,cAAMA,KAAK,CAAC,iBAAD,CAAX;AACH;;AAEDlB,MAAAA,QAAQ,CAACN,YAAY,CAACkB,OAAD,CAAb,CAAR;AACAZ,MAAAA,QAAQ,CAACmB,iBAAiB,CAACP,OAAD,CAAlB,CAAR;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAYH,OAAZ;AACH,KAxBD,CAwBC,OAAMQ,KAAN,EAAY;AACTN,MAAAA,OAAO,CAACC,GAAR,CAAYK,KAAZ;AACApB,MAAAA,QAAQ,CAACP,SAAS,CAAC2B,KAAD,CAAV,CAAR;AACH;AACJ,GAzFG;AA0FH,CA5FD;;AA8FA,eAAexB,UAAf","sourcesContent":["import {thumpBegin, thumpFail, thumpSuccess, updateSingleImageThumpDown, } from './thumpAction'\n\n\nconst thumpThunk = (imageId, token, thumpUpResolver = true)=>{\n\n    return async dispatch =>{ \n        dispatch(thumpBegin())\n\n    // thumpUpResolver is true if the thunk will make a fetch request to thumpUpMutation\n    let graphqlQuery\n\n    if(thumpUpResolver){\n        graphqlQuery = {\n            query: `\n            mutation thumpUp($imageId: ID!){\n                thumpUpMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n\n                    imageId\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n            variables:{\n                imageId:imageId\n            }\n        }\n\n    }else{\n        graphqlQuery = {\n            query: `\n            mutation thumpDown($imageId: ID!){\n                thumpDownMutation(imageId: $imageId){\n                    thumpUp{\n                        thumpUpCount\n                        userActionThumpUp{\n                            _id\n                        }\n                    }\n                    imageId\n                    thumpDown{\n                        thumpDownCount\n                        userActionThumpDown{\n                            _id\n                        }\n                    }\n\n                }\n            }`,\n            variables:{\n                imageId\n            }\n\n        }\n    }\n\n    try{\n\n        const response = await fetch('http://localhost:5000/graphql',{\n            method: 'POST',\n            headers:{\n                'Content-Type': 'application/json',\n                Authorization: 'Bearer ' + token\n            },\n            body: JSON.stringify(graphqlQuery)\n        })\n\n        const resData = await response.json()\n        console.log(resData)\n        if(resData.errors){\n            console.log(resData.errors)\n            if(resData.errors[0].status === 401){\n                throw Error('You are not authorized')\n            }\n            throw Error('Image not found')\n        }\n\n        dispatch(thumpSuccess(resData))\n        dispatch(updateSingleImage(resData))\n        console.log(resData)\n    }catch(error){\n        console.log(error)\n        dispatch(thumpFail(error))\n    }\n}\n}\n\nexport default thumpThunk"]},"metadata":{},"sourceType":"module"}